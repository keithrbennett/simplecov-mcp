<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="MCP server, command line utility, and library for Ruby SimpleCov test coverage analysis"><link href=https://keithrbennett.github.io/cov-loupe/user/CLI_USAGE/ rel=canonical><link href=../ rel=prev><link href=../MCP_INTEGRATION/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.7.1"><title>CLI Usage - CovLoupe Documentation</title><link rel=stylesheet href=../../assets/stylesheets/main.484c7ddc.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../assets/stylesheets/branding.css><link rel=stylesheet href=../../assets/stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#cli-usage-guide class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="CovLoupe Documentation" class="md-header__button md-logo" aria-label="CovLoupe Documentation" data-md-component=logo> <img src=../../assets/images/cov-loupe-logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> CovLoupe Documentation </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> CLI Usage </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/keithrbennett/cov-loupe title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> keithrbennett/cov-loupe </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../INSTALLATION/ class=md-tabs__link> Getting Started </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../ class=md-tabs__link> User Guide </a> </li> <li class=md-tabs__item> <a href=../migrations/ class=md-tabs__link> Migrations </a> </li> <li class=md-tabs__item> <a href=../prompts/ class=md-tabs__link> Prompt Library </a> </li> <li class=md-tabs__item> <a href=../../dev/ class=md-tabs__link> Developer Guide </a> </li> <li class=md-tabs__item> <a href=../../contributing/ class=md-tabs__link> Contributing </a> </li> <li class=md-tabs__item> <a href=../../code_of_conduct/ class=md-tabs__link> Code of Conduct </a> </li> <li class=md-tabs__item> <a href=../../release_notes/ class=md-tabs__link> Release Notes </a> </li> <li class=md-tabs__item> <a href=../../license/ class=md-tabs__link> License </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="CovLoupe Documentation" class="md-nav__button md-logo" aria-label="CovLoupe Documentation" data-md-component=logo> <img src=../../assets/images/cov-loupe-logo.png alt=logo> </a> CovLoupe Documentation </label> <div class=md-nav__source> <a href=https://github.com/keithrbennett/cov-loupe title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> keithrbennett/cov-loupe </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Getting Started </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Getting Started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../INSTALLATION/ class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class=md-nav__item> <a href=../../QUICKSTART/ class=md-nav__link> <span class=md-ellipsis> Quick Start </span> </a> </li> <li class=md-nav__item> <a href=../EXAMPLES/ class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> <li class=md-nav__item> <a href=../../examples/mcp-inputs/ class=md-nav__link> <span class=md-ellipsis> MCP Input Examples </span> </a> </li> <li class=md-nav__item> <a href=../../examples/success_predicates/ class=md-nav__link> <span class=md-ellipsis> Success Predicate Examples </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> User Guide </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> User Guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> CLI Usage </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> CLI Usage </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#table-of-contents class=md-nav__link> <span class=md-ellipsis> Table of Contents </span> </a> </li> <li class=md-nav__item> <a href=#quick-reference class=md-nav__link> <span class=md-ellipsis> Quick Reference </span> </a> </li> <li class=md-nav__item> <a href=#subcommands class=md-nav__link> <span class=md-ellipsis> Subcommands </span> </a> <nav class=md-nav aria-label=Subcommands> <ul class=md-nav__list> <li class=md-nav__item> <a href=#list class=md-nav__link> <span class=md-ellipsis> list </span> </a> </li> <li class=md-nav__item> <a href=#summary-path class=md-nav__link> <span class=md-ellipsis> summary &lt;path&gt; </span> </a> </li> <li class=md-nav__item> <a href=#uncovered-path class=md-nav__link> <span class=md-ellipsis> uncovered &lt;path&gt; </span> </a> </li> <li class=md-nav__item> <a href=#detailed-path class=md-nav__link> <span class=md-ellipsis> detailed &lt;path&gt; </span> </a> </li> <li class=md-nav__item> <a href=#raw-path class=md-nav__link> <span class=md-ellipsis> raw &lt;path&gt; </span> </a> </li> <li class=md-nav__item> <a href=#totals class=md-nav__link> <span class=md-ellipsis> totals </span> </a> </li> <li class=md-nav__item> <a href=#version class=md-nav__link> <span class=md-ellipsis> version </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#global-options class=md-nav__link> <span class=md-ellipsis> Global Options </span> </a> <nav class=md-nav aria-label="Global Options"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#-r-resultset-path class=md-nav__link> <span class=md-ellipsis> -r, --resultset PATH </span> </a> </li> <li class=md-nav__item> <a href=#-r-root-path class=md-nav__link> <span class=md-ellipsis> -R, --root PATH </span> </a> </li> <li class=md-nav__item> <a href=#-fp class=md-nav__link> <span class=md-ellipsis> -fp </span> </a> </li> <li class=md-nav__item> <a href=#-o-sort-order-order class=md-nav__link> <span class=md-ellipsis> -o, --sort-order ORDER </span> </a> </li> <li class=md-nav__item> <a href=#-s-source-mode class=md-nav__link> <span class=md-ellipsis> -s, --source MODE </span> </a> </li> <li class=md-nav__item> <a href=#-c-context-lines-n class=md-nav__link> <span class=md-ellipsis> -c, --context-lines N </span> </a> </li> <li class=md-nav__item> <a href=#boolean-flags-color-c-raise-on-stale class=md-nav__link> <span class=md-ellipsis> Boolean Flags (--color / -C, --raise-on-stale) </span> </a> </li> <li class=md-nav__item> <a href=#-c-color-boolean class=md-nav__link> <span class=md-ellipsis> -C, --color BOOLEAN </span> </a> </li> <li class=md-nav__item> <a href=#-s-raise-on-stale-boolean class=md-nav__link> <span class=md-ellipsis> -S, --raise-on-stale BOOLEAN </span> </a> </li> <li class=md-nav__item> <a href=#-g-tracked-globs-patterns class=md-nav__link> <span class=md-ellipsis> -g, --tracked-globs PATTERNS </span> </a> </li> <li class=md-nav__item> <a href=#-l-log-file-path class=md-nav__link> <span class=md-ellipsis> -l, --log-file PATH </span> </a> </li> <li class=md-nav__item> <a href=#-e-error-mode-mode class=md-nav__link> <span class=md-ellipsis> -e, --error-mode MODE </span> </a> </li> <li class=md-nav__item> <a href=#-o-output-chars-mode class=md-nav__link> <span class=md-ellipsis> -O, --output-chars MODE </span> </a> </li> <li class=md-nav__item> <a href=#-m-mode-mode class=md-nav__link> <span class=md-ellipsis> -m, --mode MODE </span> </a> </li> <li class=md-nav__item> <a href=#validate-subcommand class=md-nav__link> <span class=md-ellipsis> validate Subcommand </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#output-formats class=md-nav__link> <span class=md-ellipsis> Output Formats </span> </a> <nav class=md-nav aria-label="Output Formats"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#table-format class=md-nav__link> <span class=md-ellipsis> Table Format </span> </a> </li> <li class=md-nav__item> <a href=#json-format class=md-nav__link> <span class=md-ellipsis> JSON Format </span> </a> </li> <li class=md-nav__item> <a href=#source-display class=md-nav__link> <span class=md-ellipsis> Source Display </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#environment-variables class=md-nav__link> <span class=md-ellipsis> Environment Variables </span> </a> <nav class=md-nav aria-label="Environment Variables"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cov_loupe_opts class=md-nav__link> <span class=md-ellipsis> COV_LOUPE_OPTS </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#examples class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> <nav class=md-nav aria-label=Examples> <ul class=md-nav__list> <li class=md-nav__item> <a href=#basic-coverage-check class=md-nav__link> <span class=md-ellipsis> Basic Coverage Check </span> </a> </li> <li class=md-nav__item> <a href=#detailed-file-investigation class=md-nav__link> <span class=md-ellipsis> Detailed File Investigation </span> </a> </li> <li class=md-nav__item> <a href=#json-output-for-scripts class=md-nav__link> <span class=md-ellipsis> JSON Output for Scripts </span> </a> </li> <li class=md-nav__item> <a href=#filtering-and-sorting class=md-nav__link> <span class=md-ellipsis> Filtering and Sorting </span> </a> </li> <li class=md-nav__item> <a href=#staleness-checking class=md-nav__link> <span class=md-ellipsis> Staleness Checking </span> </a> </li> <li class=md-nav__item> <a href=#source-code-display class=md-nav__link> <span class=md-ellipsis> Source Code Display </span> </a> </li> <li class=md-nav__item> <a href=#cicd-integration class=md-nav__link> <span class=md-ellipsis> CI/CD Integration </span> </a> </li> <li class=md-nav__item> <a href=#debugging class=md-nav__link> <span class=md-ellipsis> Debugging </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#exit-codes class=md-nav__link> <span class=md-ellipsis> Exit Codes </span> </a> </li> <li class=md-nav__item> <a href=#next-steps class=md-nav__link> <span class=md-ellipsis> Next Steps </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../MCP_INTEGRATION/ class=md-nav__link> <span class=md-ellipsis> MCP Integration </span> </a> </li> <li class=md-nav__item> <a href=../LIBRARY_API/ class=md-nav__link> <span class=md-ellipsis> Library API </span> </a> </li> <li class=md-nav__item> <a href=../ADVANCED_USAGE/ class=md-nav__link> <span class=md-ellipsis> Advanced Usage </span> </a> </li> <li class=md-nav__item> <a href=../ERROR_HANDLING/ class=md-nav__link> <span class=md-ellipsis> Error Handling </span> </a> </li> <li class=md-nav__item> <a href=../TROUBLESHOOTING/ class=md-nav__link> <span class=md-ellipsis> Troubleshooting </span> </a> </li> <li class=md-nav__item> <a href=../CLI_FALLBACK_FOR_LLMS/ class=md-nav__link> <span class=md-ellipsis> CLI Fallback for LLMs </span> </a> </li> <li class=md-nav__item> <a href=../installing-a-prelease-version-of-covloupe/ class=md-nav__link> <span class=md-ellipsis> Installing a Prerelease </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Migrations </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Migrations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../migrations/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../migrations/MIGRATING_TO_V4/ class=md-nav__link> <span class=md-ellipsis> Migrating to v4 </span> </a> </li> <li class=md-nav__item> <a href=../migrations/MIGRATING_TO_V3/ class=md-nav__link> <span class=md-ellipsis> Migrating to v3 </span> </a> </li> <li class=md-nav__item> <a href=../migrations/MIGRATING_TO_V2/ class=md-nav__link> <span class=md-ellipsis> Migrating to v2 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Prompt Library </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Prompt Library </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../prompts/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../prompts/coverage-analysis-prompt/ class=md-nav__link> <span class=md-ellipsis> Coverage Analysis </span> </a> </li> <li class=md-nav__item> <a href=../prompts/use-cli-not-mcp-prompt/ class=md-nav__link> <span class=md-ellipsis> Use CLI Not MCP </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Developer Guide </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Developer Guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../dev/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../dev/ARCHITECTURE/ class=md-nav__link> <span class=md-ellipsis> Architecture </span> </a> </li> <li class=md-nav__item> <a href=../../dev/DEVELOPMENT/ class=md-nav__link> <span class=md-ellipsis> Development </span> </a> </li> <li class=md-nav__item> <a href=../../dev/RELEASING/ class=md-nav__link> <span class=md-ellipsis> Releasing </span> </a> </li> <li class=md-nav__item> <a href=../../dev/FUTURE_ENHANCEMENTS/ class=md-nav__link> <span class=md-ellipsis> Future Enhancements </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6_6> <label class=md-nav__link for=__nav_6_6 id=__nav_6_6_label tabindex=0> <span class=md-ellipsis> Architecture Decisions </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6_6> <span class="md-nav__icon md-icon"></span> Architecture Decisions </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../dev/arch-decisions/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../dev/arch-decisions/application-architecture/ class=md-nav__link> <span class=md-ellipsis> Application Architecture </span> </a> </li> <li class=md-nav__item> <a href=../../dev/arch-decisions/coverage-data-quality/ class=md-nav__link> <span class=md-ellipsis> Coverage Data Quality </span> </a> </li> <li class=md-nav__item> <a href=../../dev/arch-decisions/path-resolution/ class=md-nav__link> <span class=md-ellipsis> Path Resolution </span> </a> </li> <li class=md-nav__item> <a href=../../dev/arch-decisions/policy-validation/ class=md-nav__link> <span class=md-ellipsis> Policy Validation </span> </a> </li> <li class=md-nav__item> <a href=../../dev/arch-decisions/simplecov-integration/ class=md-nav__link> <span class=md-ellipsis> SimpleCov Integration </span> </a> </li> <li class=md-nav__item> <a href=../../dev/arch-decisions/output-character-mode/ class=md-nav__link> <span class=md-ellipsis> Output Character Mode </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../dev/presentations/cov-loupe-presentation/ class=md-nav__link> <span class=md-ellipsis> Presentations </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../contributing/ class=md-nav__link> <span class=md-ellipsis> Contributing </span> </a> </li> <li class=md-nav__item> <a href=../../code_of_conduct/ class=md-nav__link> <span class=md-ellipsis> Code of Conduct </span> </a> </li> <li class=md-nav__item> <a href=../../release_notes/ class=md-nav__link> <span class=md-ellipsis> Release Notes </span> </a> </li> <li class=md-nav__item> <a href=../../license/ class=md-nav__link> <span class=md-ellipsis> License </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#table-of-contents class=md-nav__link> <span class=md-ellipsis> Table of Contents </span> </a> </li> <li class=md-nav__item> <a href=#quick-reference class=md-nav__link> <span class=md-ellipsis> Quick Reference </span> </a> </li> <li class=md-nav__item> <a href=#subcommands class=md-nav__link> <span class=md-ellipsis> Subcommands </span> </a> <nav class=md-nav aria-label=Subcommands> <ul class=md-nav__list> <li class=md-nav__item> <a href=#list class=md-nav__link> <span class=md-ellipsis> list </span> </a> </li> <li class=md-nav__item> <a href=#summary-path class=md-nav__link> <span class=md-ellipsis> summary &lt;path&gt; </span> </a> </li> <li class=md-nav__item> <a href=#uncovered-path class=md-nav__link> <span class=md-ellipsis> uncovered &lt;path&gt; </span> </a> </li> <li class=md-nav__item> <a href=#detailed-path class=md-nav__link> <span class=md-ellipsis> detailed &lt;path&gt; </span> </a> </li> <li class=md-nav__item> <a href=#raw-path class=md-nav__link> <span class=md-ellipsis> raw &lt;path&gt; </span> </a> </li> <li class=md-nav__item> <a href=#totals class=md-nav__link> <span class=md-ellipsis> totals </span> </a> </li> <li class=md-nav__item> <a href=#version class=md-nav__link> <span class=md-ellipsis> version </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#global-options class=md-nav__link> <span class=md-ellipsis> Global Options </span> </a> <nav class=md-nav aria-label="Global Options"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#-r-resultset-path class=md-nav__link> <span class=md-ellipsis> -r, --resultset PATH </span> </a> </li> <li class=md-nav__item> <a href=#-r-root-path class=md-nav__link> <span class=md-ellipsis> -R, --root PATH </span> </a> </li> <li class=md-nav__item> <a href=#-fp class=md-nav__link> <span class=md-ellipsis> -fp </span> </a> </li> <li class=md-nav__item> <a href=#-o-sort-order-order class=md-nav__link> <span class=md-ellipsis> -o, --sort-order ORDER </span> </a> </li> <li class=md-nav__item> <a href=#-s-source-mode class=md-nav__link> <span class=md-ellipsis> -s, --source MODE </span> </a> </li> <li class=md-nav__item> <a href=#-c-context-lines-n class=md-nav__link> <span class=md-ellipsis> -c, --context-lines N </span> </a> </li> <li class=md-nav__item> <a href=#boolean-flags-color-c-raise-on-stale class=md-nav__link> <span class=md-ellipsis> Boolean Flags (--color / -C, --raise-on-stale) </span> </a> </li> <li class=md-nav__item> <a href=#-c-color-boolean class=md-nav__link> <span class=md-ellipsis> -C, --color BOOLEAN </span> </a> </li> <li class=md-nav__item> <a href=#-s-raise-on-stale-boolean class=md-nav__link> <span class=md-ellipsis> -S, --raise-on-stale BOOLEAN </span> </a> </li> <li class=md-nav__item> <a href=#-g-tracked-globs-patterns class=md-nav__link> <span class=md-ellipsis> -g, --tracked-globs PATTERNS </span> </a> </li> <li class=md-nav__item> <a href=#-l-log-file-path class=md-nav__link> <span class=md-ellipsis> -l, --log-file PATH </span> </a> </li> <li class=md-nav__item> <a href=#-e-error-mode-mode class=md-nav__link> <span class=md-ellipsis> -e, --error-mode MODE </span> </a> </li> <li class=md-nav__item> <a href=#-o-output-chars-mode class=md-nav__link> <span class=md-ellipsis> -O, --output-chars MODE </span> </a> </li> <li class=md-nav__item> <a href=#-m-mode-mode class=md-nav__link> <span class=md-ellipsis> -m, --mode MODE </span> </a> </li> <li class=md-nav__item> <a href=#validate-subcommand class=md-nav__link> <span class=md-ellipsis> validate Subcommand </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#output-formats class=md-nav__link> <span class=md-ellipsis> Output Formats </span> </a> <nav class=md-nav aria-label="Output Formats"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#table-format class=md-nav__link> <span class=md-ellipsis> Table Format </span> </a> </li> <li class=md-nav__item> <a href=#json-format class=md-nav__link> <span class=md-ellipsis> JSON Format </span> </a> </li> <li class=md-nav__item> <a href=#source-display class=md-nav__link> <span class=md-ellipsis> Source Display </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#environment-variables class=md-nav__link> <span class=md-ellipsis> Environment Variables </span> </a> <nav class=md-nav aria-label="Environment Variables"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cov_loupe_opts class=md-nav__link> <span class=md-ellipsis> COV_LOUPE_OPTS </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#examples class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> <nav class=md-nav aria-label=Examples> <ul class=md-nav__list> <li class=md-nav__item> <a href=#basic-coverage-check class=md-nav__link> <span class=md-ellipsis> Basic Coverage Check </span> </a> </li> <li class=md-nav__item> <a href=#detailed-file-investigation class=md-nav__link> <span class=md-ellipsis> Detailed File Investigation </span> </a> </li> <li class=md-nav__item> <a href=#json-output-for-scripts class=md-nav__link> <span class=md-ellipsis> JSON Output for Scripts </span> </a> </li> <li class=md-nav__item> <a href=#filtering-and-sorting class=md-nav__link> <span class=md-ellipsis> Filtering and Sorting </span> </a> </li> <li class=md-nav__item> <a href=#staleness-checking class=md-nav__link> <span class=md-ellipsis> Staleness Checking </span> </a> </li> <li class=md-nav__item> <a href=#source-code-display class=md-nav__link> <span class=md-ellipsis> Source Code Display </span> </a> </li> <li class=md-nav__item> <a href=#cicd-integration class=md-nav__link> <span class=md-ellipsis> CI/CD Integration </span> </a> </li> <li class=md-nav__item> <a href=#debugging class=md-nav__link> <span class=md-ellipsis> Debugging </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#exit-codes class=md-nav__link> <span class=md-ellipsis> Exit Codes </span> </a> </li> <li class=md-nav__item> <a href=#next-steps class=md-nav__link> <span class=md-ellipsis> Next Steps </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=cli-usage-guide>CLI Usage Guide<a class=headerlink href=#cli-usage-guide title="Permanent link">&para;</a></h1> <p><a href=../../ >Back to main README</a></p> <p>Complete reference for using cov-loupe from the command line.</p> <blockquote> <p>Docs use <code>clp</code> as a shortcut pointing at the demo fixture with partial coverage: <code>alias clp='cov-loupe -R docs/fixtures/demo_project'</code> # -R = --root Replace <code>clp</code> with <code>cov-loupe</code> to run commands against your own project. The demo fixture is a small Rails-like project in <code>docs/fixtures/demo_project</code> with intentional coverage gaps for testing <code>--tracked-globs</code>.</p> </blockquote> <h2 id=table-of-contents>Table of Contents<a class=headerlink href=#table-of-contents title="Permanent link">&para;</a></h2> <ul> <li><a href=#quick-reference>Quick Reference</a></li> <li><a href=#subcommands>Subcommands</a></li> <li><a href=#global-options>Global Options</a></li> <li><a href=#output-formats>Output Formats</a></li> <li><a href=#environment-variables>Environment Variables</a></li> <li><a href=#examples>Examples</a></li> </ul> <h2 id=quick-reference>Quick Reference<a class=headerlink href=#quick-reference title="Permanent link">&para;</a></h2> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=c1># Show coverage table for all files</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>clp
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>clp<span class=w> </span>list
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=c1># Check specific file</span>
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>clp<span class=w> </span>summary<span class=w> </span>app/models/order.rb
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a>
<a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=c1># Find uncovered lines</span>
<a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a>clp<span class=w> </span>uncovered<span class=w> </span>app/models/order.rb
<a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a>
<a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a><span class=c1># Get detailed per-line coverage</span>
<a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a>clp<span class=w> </span>detailed<span class=w> </span>app/models/order.rb
<a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a>
<a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a><span class=c1># Get raw SimpleCov data</span>
<a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a>clp<span class=w> </span>raw<span class=w> </span>app/models/order.rb
<a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a>
<a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a><span class=c1># Get project totals</span>
<a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a>clp<span class=w> </span>totals
<a id=__codelineno-0-19 name=__codelineno-0-19 href=#__codelineno-0-19></a>clp<span class=w> </span>-fp<span class=w> </span>totals
<a id=__codelineno-0-20 name=__codelineno-0-20 href=#__codelineno-0-20></a>
<a id=__codelineno-0-21 name=__codelineno-0-21 href=#__codelineno-0-21></a><span class=c1># Show version</span>
<a id=__codelineno-0-22 name=__codelineno-0-22 href=#__codelineno-0-22></a>clp<span class=w> </span>version
<a id=__codelineno-0-23 name=__codelineno-0-23 href=#__codelineno-0-23></a>
<a id=__codelineno-0-24 name=__codelineno-0-24 href=#__codelineno-0-24></a><span class=c1># Get help</span>
<a id=__codelineno-0-25 name=__codelineno-0-25 href=#__codelineno-0-25></a>clp<span class=w> </span>-h<span class=w>  </span><span class=c1># -h = --help</span>
</code></pre></div> <h2 id=subcommands>Subcommands<a class=headerlink href=#subcommands title="Permanent link">&para;</a></h2> <h3 id=list><code>list</code><a class=headerlink href=#list title="Permanent link">&para;</a></h3> <p>Show coverage summary for all files (default subcommand).</p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a>clp<span class=w> </span>list
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>clp<span class=w> </span>-o<span class=w> </span>d<span class=w> </span>list<span class=w>  </span><span class=c1># -o = --sort-order, d = descending</span>
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>clp<span class=w> </span>-fp<span class=w> </span>list<span class=w>           </span>
</code></pre></div> <p>Default sort order is descending (highest coverage first) so the lowest-coverage files stay visible at the bottom of the scrollback.</p> <p><strong>Options:</strong></p> <table> <thead> <tr> <th>Short</th> <th>Long</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>-o</code></td> <td><code>--sort-order</code></td> <td>Sort by coverage percentage (ascending or descending)</td> </tr> <tr> <td><code>-g</code></td> <td><code>--tracked-globs</code></td> <td>Filter to specific file patterns</td> </tr> <tr> <td><code>-S</code></td> <td><code>--raise-on-stale</code></td> <td>Raise error if coverage is stale (default false)</td> </tr> <tr> <td><code>-fp</code></td> <td><code>--format pretty-json</code></td> <td>Output as pretty-printed JSON</td> </tr> <tr> <td><code>-fj</code></td> <td><code>--format json</code></td> <td>Output as single-line JSON</td> </tr> <tr> <td><code>-f y</code></td> <td><code>--format yaml</code></td> <td>Output as YAML</td> </tr> <tr> <td><code>-f ap</code></td> <td><code>--format amazing_print</code></td> <td>Output using AmazingPrint</td> </tr> </tbody> </table> <p><strong>Output (table format):</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a>┌────────────────────────────────────────┬──────────┬───────────┬─────────┬───────┐
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>│ File                                   │        % │   Covered │   Total │ Stale │
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>├────────────────────────────────────────┼──────────┼───────────┼─────────┼───────┤
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a>│ app/models/user.rb                     │  100.00% │         6 │       6 │       │
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>│ lib/api/client.rb                      │   88.89% │         8 │       9 │       │
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a>│ app/models/order.rb                    │   85.71% │         6 │       7 │       │
<a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a>│ lib/ops/jobs/report_job.rb             │   80.00% │         4 │       5 │       │
<a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a>│ lib/payments/processor.rb              │   80.00% │         4 │       5 │       │
<a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a>│ app/controllers/orders_controller.rb   │   70.00% │         7 │      10 │       │
<a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a>│ lib/payments/refund_service.rb         │   60.00% │         3 │       5 │       │
<a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a>└────────────────────────────────────────┴──────────┴───────────┴─────────┴───────┘
<a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a>Files: total 7, ok 7, stale 0
</code></pre></div></p> <p><strong>Stale indicators:</strong> missing (missing file), newer (timestamp mismatch), length_mismatch (line count mismatch), error (staleness check error)</p> <h3 id=summary-path><code>summary &lt;path&gt;</code><a class=headerlink href=#summary-path title="Permanent link">&para;</a></h3> <p>Show covered/total/percentage for a specific file.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a>clp<span class=w> </span>summary<span class=w> </span>app/models/order.rb
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>clp<span class=w> </span>-fp<span class=w> </span>summary<span class=w> </span>app/models/order.rb
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>clp<span class=w> </span>-s<span class=w> </span>full<span class=w> </span>summary<span class=w> </span>app/models/order.rb<span class=w>  </span><span class=c1># -s = --source</span>
</code></pre></div> <p><strong>Arguments:</strong> - <code>&lt;path&gt;</code> - File path (relative to project root or absolute)</p> <p><strong>Options:</strong></p> <table> <thead> <tr> <th>Short</th> <th>Long</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>-fp</code></td> <td><code>--format pretty-json</code></td> <td>Output as pretty-printed JSON</td> </tr> <tr> <td><code>-fj</code></td> <td><code>--format json</code></td> <td>Output as single-line JSON</td> </tr> <tr> <td><code>-f y</code></td> <td><code>--format yaml</code></td> <td>Output as YAML</td> </tr> <tr> <td><code>-f ap</code></td> <td><code>--format amazing_print</code></td> <td>Output using AmazingPrint</td> </tr> <tr> <td><code>-s</code></td> <td><code>--source MODE</code></td> <td>Include source code (full or uncovered)</td> </tr> </tbody> </table> <p><strong>Output (default format):</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a>┌───────────────────────┬──────────┬─────────┬───────┬───────┐
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>│ File                  │        % │ Covered │ Total │ Stale │
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a>├───────────────────────┼──────────┼─────────┼───────┼───────┤
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>│ app/models/order.rb   │   85.71% │       6 │     7 │       │
<a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a>└───────────────────────┴──────────┴─────────┴───────┴───────┘
</code></pre></div></p> <p><strong>Output (JSON format):</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=p>{</span>
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=w>  </span><span class=nt>&quot;file&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;app/models/order.rb&quot;</span><span class=p>,</span>
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=w>  </span><span class=nt>&quot;summary&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=w>    </span><span class=nt>&quot;covered&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>6</span><span class=p>,</span>
<a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=w>    </span><span class=nt>&quot;total&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>7</span><span class=p>,</span>
<a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a><span class=w>    </span><span class=nt>&quot;percentage&quot;</span><span class=p>:</span><span class=w> </span><span class=mf>85.71</span>
<a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=w>  </span><span class=p>},</span>
<a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=w>  </span><span class=nt>&quot;stale&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;ok&quot;</span>
<a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a><span class=p>}</span>
</code></pre></div></p> <h3 id=uncovered-path><code>uncovered &lt;path&gt;</code><a class=headerlink href=#uncovered-path title="Permanent link">&para;</a></h3> <p>Show uncovered line numbers for a specific file.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a>clp<span class=w> </span>uncovered<span class=w> </span>app/controllers/orders_controller.rb
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>clp<span class=w> </span>-s<span class=w> </span>uncovered<span class=w> </span>uncovered<span class=w> </span>app/controllers/orders_controller.rb<span class=w>  </span><span class=c1># -s = --source</span>
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>clp<span class=w> </span>-s<span class=w> </span>uncovered<span class=w> </span>-c<span class=w> </span><span class=m>3</span><span class=w> </span>uncovered<span class=w> </span>app/controllers/orders_controller.rb<span class=w>  </span><span class=c1># -s = --source, -c = --context-lines</span>
</code></pre></div> <p><strong>Arguments:</strong> - <code>&lt;path&gt;</code> - File path (relative to project root or absolute)</p> <p><strong>Options:</strong></p> <table> <thead> <tr> <th>Short</th> <th>Long</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>-s</code></td> <td><code>--source uncovered</code></td> <td>Show uncovered lines with context</td> </tr> <tr> <td><code>-c</code></td> <td><code>--context-lines N</code></td> <td>Lines of context around uncovered lines (default: 2)</td> </tr> <tr> <td><code>-C</code></td> <td><code>--color BOOLEAN</code></td> <td>Enable (<code>true</code>)/disable (<code>false</code>) syntax coloring</td> </tr> <tr> <td><code>-fp</code></td> <td><code>--format pretty-json</code></td> <td>Output as pretty-printed JSON</td> </tr> <tr> <td><code>-fj</code></td> <td><code>--format json</code></td> <td>Output as single-line JSON</td> </tr> <tr> <td><code>-f y</code></td> <td><code>--format yaml</code></td> <td>Output as YAML</td> </tr> <tr> <td><code>-f ap</code></td> <td><code>--format amazing_print</code></td> <td>Output using AmazingPrint</td> </tr> </tbody> </table> <p><strong>Output (default format):</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a>File:            app/controllers/orders_controller.rb
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>Uncovered lines: 14, 15, 20
<a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>Summary:         70.0%      7/10
</code></pre></div></p> <p><strong>Output (with source):</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a>File:            app/controllers/orders_controller.rb
<a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>Uncovered lines: 14, 15, 20
<a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a>Summary:         70.0%      7/10
<a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a>
<a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a>  Line     | Source
<a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a>  ------+-----------------------------------------------------------
<a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a>    14  · |       def show(id)
<a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a>    15  · |         @repo.find(id)
<a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a>    16  ✓ |       end
<a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a>    17    |
<a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a>    18  ✓ |       def cancel(id)
<a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a>    19  ✓ |         order = @repo.find(id)
<a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a>    20  · |         return :missing unless order
</code></pre></div></p> <p><strong>Legend:</strong> - <code>✓</code> - Line is covered - <code>·</code> - Line is not covered - <code></code> - Line is not executable (comments, blank lines)</p> <h3 id=detailed-path><code>detailed &lt;path&gt;</code><a class=headerlink href=#detailed-path title="Permanent link">&para;</a></h3> <p>Show per-line coverage with hit counts.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a>clp<span class=w> </span>detailed<span class=w> </span>app/models/order.rb
<a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>clp<span class=w> </span>-fp<span class=w> </span>detailed<span class=w> </span>app/models/order.rb
<a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a>clp<span class=w> </span>-s<span class=w> </span>full<span class=w> </span>detailed<span class=w> </span>app/models/order.rb<span class=w>  </span><span class=c1># -s = --source</span>
</code></pre></div> <p><strong>Arguments:</strong> - <code>&lt;path&gt;</code> - File path (relative to project root or absolute)</p> <p><strong>Options:</strong></p> <table> <thead> <tr> <th>Short</th> <th>Long</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>-fp</code></td> <td><code>--format pretty-json</code></td> <td>Output as pretty-printed JSON</td> </tr> <tr> <td><code>-fj</code></td> <td><code>--format json</code></td> <td>Output as single-line JSON</td> </tr> <tr> <td><code>-f y</code></td> <td><code>--format yaml</code></td> <td>Output as YAML</td> </tr> <tr> <td><code>-f ap</code></td> <td><code>--format amazing_print</code></td> <td>Output using AmazingPrint</td> </tr> <tr> <td><code>-s</code></td> <td><code>--source MODE</code></td> <td>Include source code</td> </tr> </tbody> </table> <p><strong>Output (default format):</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a>File: app/models/order.rb
<a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>Coverage: 6/7 lines (85.71%)
<a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a>
<a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a>┌──────┬──────┬─────────┐
<a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a>│ Line │ Hits │ Covered │
<a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a>├──────┼──────┼─────────┤
<a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a>│    6 │    1 │   yes   │
<a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a>│    7 │    1 │   yes   │
<a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a>│    8 │    1 │   yes   │
<a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a>│   11 │    1 │   yes   │
<a id=__codelineno-10-11 name=__codelineno-10-11 href=#__codelineno-10-11></a>│   12 │    1 │   yes   │
<a id=__codelineno-10-12 name=__codelineno-10-12 href=#__codelineno-10-12></a>│   15 │    1 │   yes   │
<a id=__codelineno-10-13 name=__codelineno-10-13 href=#__codelineno-10-13></a>│   16 │    0 │   no    │
<a id=__codelineno-10-14 name=__codelineno-10-14 href=#__codelineno-10-14></a>└──────┴──────┴─────────┘
</code></pre></div></p> <p><strong>Output (JSON format):</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=p>{</span>
<a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=w>  </span><span class=nt>&quot;file&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;app/models/order.rb&quot;</span><span class=p>,</span>
<a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a><span class=w>  </span><span class=nt>&quot;lines&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
<a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a><span class=w>    </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;line&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>6</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;hits&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;covered&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w> </span><span class=p>},</span>
<a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a><span class=w>    </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;line&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>7</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;hits&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;covered&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w> </span><span class=p>},</span>
<a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a><span class=w>    </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;line&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>8</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;hits&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;covered&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w> </span><span class=p>},</span>
<a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a><span class=w>    </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;line&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>11</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;hits&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;covered&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w> </span><span class=p>},</span>
<a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a><span class=w>    </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;line&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>12</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;hits&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;covered&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w> </span><span class=p>},</span>
<a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a><span class=w>    </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;line&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>15</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;hits&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;covered&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w> </span><span class=p>},</span>
<a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a><span class=w>    </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;line&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>16</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;hits&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;covered&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w> </span><span class=p>}</span>
<a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a><span class=w>  </span><span class=p>],</span>
<a id=__codelineno-11-12 name=__codelineno-11-12 href=#__codelineno-11-12></a><span class=w>  </span><span class=nt>&quot;summary&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-11-13 name=__codelineno-11-13 href=#__codelineno-11-13></a><span class=w>    </span><span class=nt>&quot;covered&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>6</span><span class=p>,</span>
<a id=__codelineno-11-14 name=__codelineno-11-14 href=#__codelineno-11-14></a><span class=w>    </span><span class=nt>&quot;total&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>7</span><span class=p>,</span>
<a id=__codelineno-11-15 name=__codelineno-11-15 href=#__codelineno-11-15></a><span class=w>    </span><span class=nt>&quot;percentage&quot;</span><span class=p>:</span><span class=w> </span><span class=mf>85.71</span>
<a id=__codelineno-11-16 name=__codelineno-11-16 href=#__codelineno-11-16></a><span class=w>  </span><span class=p>},</span>
<a id=__codelineno-11-17 name=__codelineno-11-17 href=#__codelineno-11-17></a><span class=w>  </span><span class=nt>&quot;stale&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;ok&quot;</span>
<a id=__codelineno-11-18 name=__codelineno-11-18 href=#__codelineno-11-18></a><span class=p>}</span>
</code></pre></div></p> <h3 id=raw-path><code>raw &lt;path&gt;</code><a class=headerlink href=#raw-path title="Permanent link">&para;</a></h3> <p>Show the raw SimpleCov lines array.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a>clp<span class=w> </span>raw<span class=w> </span>app/models/order.rb
<a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a>clp<span class=w> </span>-fp<span class=w> </span>raw<span class=w> </span>app/models/order.rb
</code></pre></div> <p><strong>Arguments:</strong> - <code>&lt;path&gt;</code> - File path (relative to project root or absolute)</p> <p><strong>Output (default format):</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a>File: app/models/order.rb
<a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a>[nil, nil, nil, nil, nil, 1, 1, 1, nil, nil, 1, 1, nil, nil, 1, 0, nil, nil, nil, nil]
</code></pre></div></p> <p><strong>Output (JSON format):</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=p>{</span>
<a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a><span class=w>  </span><span class=nt>&quot;file&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;app/models/order.rb&quot;</span><span class=p>,</span>
<a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a><span class=w>  </span><span class=nt>&quot;lines&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>],</span>
<a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a><span class=w>  </span><span class=nt>&quot;stale&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;ok&quot;</span>
<a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a><span class=p>}</span>
</code></pre></div></p> <p><strong>Array explanation:</strong> - Integer (e.g., <code>1</code>, <code>5</code>) - Number of times line was executed - <code>0</code> - Line is executable but was not executed - <code>null</code> - Line is not executable (comment, blank line)</p> <h3 id=totals><code>totals</code><a class=headerlink href=#totals title="Permanent link">&para;</a></h3> <p>Show aggregated totals for all tracked files.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a>clp<span class=w> </span>totals
<a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a>clp<span class=w> </span>-fp<span class=w> </span>totals
<a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a>clp<span class=w> </span>-g<span class=w> </span><span class=s2>&quot;lib/ops/jobs/*.rb&quot;</span><span class=w> </span>totals<span class=w>  </span><span class=c1># -g = --tracked-globs</span>
</code></pre></div> <p><strong>Output (default format):</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a>Tracked globs:
<a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a>  - lib/**/*.rb
<a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a>  - app/**/*.rb
<a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a>  - src/**/*.rb
<a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a>
<a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a>Totals
<a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a>┌──────────┬───────┬─────────┬───────────┬────────┐
<a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a>│ Metric   │ Total │ Covered │ Uncovered │      % │
<a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a>├──────────┼───────┼─────────┼───────────┼────────┤
<a id=__codelineno-16-10 name=__codelineno-16-10 href=#__codelineno-16-10></a>│ Lines    │    47 │      38 │         9 │ 80.85% │
<a id=__codelineno-16-11 name=__codelineno-16-11 href=#__codelineno-16-11></a>│ Files    │     7 │       7 │         0 │        │
<a id=__codelineno-16-12 name=__codelineno-16-12 href=#__codelineno-16-12></a>└──────────┴───────┴─────────┴───────────┴────────┘
<a id=__codelineno-16-13 name=__codelineno-16-13 href=#__codelineno-16-13></a>
<a id=__codelineno-16-14 name=__codelineno-16-14 href=#__codelineno-16-14></a>File breakdown:
<a id=__codelineno-16-15 name=__codelineno-16-15 href=#__codelineno-16-15></a>  With coverage: 7 total, 7 ok, 0 stale
<a id=__codelineno-16-16 name=__codelineno-16-16 href=#__codelineno-16-16></a>    Stale: missing on disk = 0, newer than coverage = 0, line mismatch = 0, unreadable = 0
<a id=__codelineno-16-17 name=__codelineno-16-17 href=#__codelineno-16-17></a>  Without coverage: 0 total
<a id=__codelineno-16-18 name=__codelineno-16-18 href=#__codelineno-16-18></a>    Missing from coverage = 0, unreadable = 0, skipped (errors) = 0
</code></pre></div></p> <p><strong>Tracked globs (shown when tracking is enabled):</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a>Tracked globs:
<a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a>  - lib/**/*.rb
<a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a>  - app/**/*.rb
</code></pre></div></p> <p><strong>Output (JSON format):</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=p>{</span>
<a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a><span class=w>  </span><span class=nt>&quot;lines&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;total&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>47</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;covered&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>38</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;uncovered&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>9</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;percent_covered&quot;</span><span class=p>:</span><span class=w> </span><span class=mf>80.85</span><span class=w> </span><span class=p>},</span>
<a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a><span class=w>  </span><span class=nt>&quot;tracking&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;enabled&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;globs&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;lib/**/*.rb&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;app/**/*.rb&quot;</span><span class=p>]</span><span class=w> </span><span class=p>},</span>
<a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a><span class=w>  </span><span class=nt>&quot;files&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a><span class=w>    </span><span class=nt>&quot;total&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>7</span><span class=p>,</span>
<a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a><span class=w>    </span><span class=nt>&quot;with_coverage&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-18-7 name=__codelineno-18-7 href=#__codelineno-18-7></a><span class=w>      </span><span class=nt>&quot;total&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>7</span><span class=p>,</span>
<a id=__codelineno-18-8 name=__codelineno-18-8 href=#__codelineno-18-8></a><span class=w>      </span><span class=nt>&quot;ok&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>7</span><span class=p>,</span>
<a id=__codelineno-18-9 name=__codelineno-18-9 href=#__codelineno-18-9></a><span class=w>      </span><span class=nt>&quot;stale&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-18-10 name=__codelineno-18-10 href=#__codelineno-18-10></a><span class=w>        </span><span class=nt>&quot;total&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>,</span>
<a id=__codelineno-18-11 name=__codelineno-18-11 href=#__codelineno-18-11></a><span class=w>        </span><span class=nt>&quot;by_type&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-18-12 name=__codelineno-18-12 href=#__codelineno-18-12></a><span class=w>          </span><span class=nt>&quot;missing_from_disk&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>,</span>
<a id=__codelineno-18-13 name=__codelineno-18-13 href=#__codelineno-18-13></a><span class=w>          </span><span class=nt>&quot;newer&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>,</span>
<a id=__codelineno-18-14 name=__codelineno-18-14 href=#__codelineno-18-14></a><span class=w>          </span><span class=nt>&quot;length_mismatch&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>,</span>
<a id=__codelineno-18-15 name=__codelineno-18-15 href=#__codelineno-18-15></a><span class=w>          </span><span class=nt>&quot;unreadable&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span>
<a id=__codelineno-18-16 name=__codelineno-18-16 href=#__codelineno-18-16></a><span class=w>        </span><span class=p>}</span>
<a id=__codelineno-18-17 name=__codelineno-18-17 href=#__codelineno-18-17></a><span class=w>      </span><span class=p>}</span>
<a id=__codelineno-18-18 name=__codelineno-18-18 href=#__codelineno-18-18></a><span class=w>    </span><span class=p>},</span>
<a id=__codelineno-18-19 name=__codelineno-18-19 href=#__codelineno-18-19></a><span class=w>    </span><span class=nt>&quot;without_coverage&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-18-20 name=__codelineno-18-20 href=#__codelineno-18-20></a><span class=w>      </span><span class=nt>&quot;total&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>,</span>
<a id=__codelineno-18-21 name=__codelineno-18-21 href=#__codelineno-18-21></a><span class=w>      </span><span class=nt>&quot;by_type&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-18-22 name=__codelineno-18-22 href=#__codelineno-18-22></a><span class=w>        </span><span class=nt>&quot;missing_from_coverage&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>,</span>
<a id=__codelineno-18-23 name=__codelineno-18-23 href=#__codelineno-18-23></a><span class=w>        </span><span class=nt>&quot;unreadable&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>,</span>
<a id=__codelineno-18-24 name=__codelineno-18-24 href=#__codelineno-18-24></a><span class=w>        </span><span class=nt>&quot;skipped&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span>
<a id=__codelineno-18-25 name=__codelineno-18-25 href=#__codelineno-18-25></a><span class=w>      </span><span class=p>}</span>
<a id=__codelineno-18-26 name=__codelineno-18-26 href=#__codelineno-18-26></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-18-27 name=__codelineno-18-27 href=#__codelineno-18-27></a><span class=w>  </span><span class=p>}</span>
<a id=__codelineno-18-28 name=__codelineno-18-28 href=#__codelineno-18-28></a><span class=p>}</span>
</code></pre></div></p> <p><strong>Notes:</strong> - <code>lines</code> are based on fresh coverage entries only. - <code>with_coverage.stale.by_type</code> uses readable labels: <code>missing_from_disk</code>, <code>newer</code>, <code>length_mismatch</code>, <code>unreadable</code>. - <code>without_coverage</code> is only present when tracking is enabled (tracked globs provided). - Respects <code>-g</code> / <code>--tracked-globs</code> when you only want to aggregate a subset of files. - Totals exclude stale files (<code>"missing"</code>, <code>"newer"</code>, <code>"length_mismatch"</code>, <code>"error"</code>) so the aggregate reflects only fresh coverage data. - Honors <code>-S</code> / <code>--raise-on-stale</code> to raise if coverage data is out of date.</p> <h3 id=version><code>version</code><a class=headerlink href=#version title="Permanent link">&para;</a></h3> <p>Show version information.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a>clp<span class=w> </span>version
<a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a>clp<span class=w> </span>-fp<span class=w> </span>version
</code></pre></div> <p><strong>Output:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a>CovLoupe version 1.0.0
</code></pre></div></p> <h2 id=global-options>Global Options<a class=headerlink href=#global-options title="Permanent link">&para;</a></h2> <p>These options work with all subcommands.</p> <h3 id=-r-resultset-path><code>-r, --resultset PATH</code><a class=headerlink href=#-r-resultset-path title="Permanent link">&para;</a></h3> <p>Path to the <code>.resultset.json</code> file or a directory containing it.</p> <p>For a detailed explanation of how to configure the resultset location, including the default search path, environment variables, and MCP configuration, see the <a href=../../#configuring-the-resultset>Configuring the Resultset</a> section in the main README.</p> <h3 id=-r-root-path><code>-R, --root PATH</code><a class=headerlink href=#-r-root-path title="Permanent link">&para;</a></h3> <p>Project root directory (default: current directory).</p> <div class=highlight><pre><span></span><code><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a>clp<span class=w> </span>-R<span class=w> </span>/path/to/project<span class=w>  </span><span class=c1># -R = --root</span>
</code></pre></div> <h3 id=-fp><code>-fp</code><a class=headerlink href=#-fp title="Permanent link">&para;</a></h3> <p>Output as pretty-printed JSON instead of human-readable format.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a>clp<span class=w> </span>-fp<span class=w> </span>summary<span class=w> </span>lib/api/client.rb
</code></pre></div> <p>Useful for: - Parsing in scripts - Integration with other tools - Machine consumption</p> <h3 id=-o-sort-order-order><code>-o, --sort-order ORDER</code><a class=headerlink href=#-o-sort-order-order title="Permanent link">&para;</a></h3> <p>Sort order for <code>list</code> subcommand.</p> <p><strong>Values:</strong> - <code>descending</code>, <code>d</code> - Highest coverage first (default) - <code>ascending</code>, <code>a</code> - Lowest coverage first</p> <div class=highlight><pre><span></span><code><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a>clp<span class=w> </span>-o<span class=w> </span>d<span class=w> </span>list<span class=w>  </span><span class=c1># d = descending (default)</span>
<a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a>clp<span class=w> </span>-o<span class=w> </span>a<span class=w> </span>list<span class=w>  </span><span class=c1># a = ascending</span>
</code></pre></div> <h3 id=-s-source-mode><code>-s, --source MODE</code><a class=headerlink href=#-s-source-mode title="Permanent link">&para;</a></h3> <p>Include source code in output.</p> <p><strong>Modes:</strong></p> <table> <thead> <tr> <th>Short</th> <th>Long</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>f</code></td> <td><code>full</code></td> <td>Show all source lines</td> </tr> <tr> <td><code>u</code></td> <td><code>uncovered</code></td> <td>Show only uncovered lines with context</td> </tr> </tbody> </table> <div class=highlight><pre><span></span><code><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=c1># Show full source</span>
<a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a>clp<span class=w> </span>-s<span class=w> </span>full<span class=w> </span>summary<span class=w> </span>lib/api/client.rb<span class=w>      </span><span class=c1># -s = --source</span>
<a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a>clp<span class=w> </span>-s<span class=w> </span>f<span class=w> </span>summary<span class=w> </span>lib/api/client.rb<span class=w>         </span><span class=c1># f = full</span>
<a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a>
<a id=__codelineno-24-5 name=__codelineno-24-5 href=#__codelineno-24-5></a><span class=c1># Show only uncovered lines</span>
<a id=__codelineno-24-6 name=__codelineno-24-6 href=#__codelineno-24-6></a>clp<span class=w> </span>-s<span class=w> </span>u<span class=w> </span>uncovered<span class=w> </span>lib/api/client.rb<span class=w>       </span><span class=c1># u = uncovered</span>
</code></pre></div> <h3 id=-c-context-lines-n><code>-c, --context-lines N</code><a class=headerlink href=#-c-context-lines-n title="Permanent link">&para;</a></h3> <p>Number of context lines around uncovered code (for <code>-s uncovered</code> / <code>--source uncovered</code>). Must be a non-negative integer.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a>clp<span class=w> </span>-s<span class=w> </span>u<span class=w> </span>-c<span class=w> </span><span class=m>3</span><span class=w> </span>uncovered<span class=w> </span>lib/api/client.rb<span class=w>  </span><span class=c1># -s u = uncovered, -c = --context-lines</span>
</code></pre></div> <p><strong>Default:</strong> 2 lines</p> <h3 id=boolean-flags-color-c-raise-on-stale>Boolean Flags (<code>--color</code> / <code>-C</code>, <code>--raise-on-stale</code>)<a class=headerlink href=#boolean-flags-color-c-raise-on-stale title="Permanent link">&para;</a></h3> <p>These options require explicit boolean values. Recognized literals:</p> <table> <thead> <tr> <th>true</th> <th>false</th> </tr> </thead> <tbody> <tr> <td><code>yes</code></td> <td><code>no</code></td> </tr> <tr> <td><code>y</code></td> <td><code>n</code></td> </tr> <tr> <td><code>true</code></td> <td><code>false</code></td> </tr> <tr> <td><code>t</code></td> <td><code>f</code></td> </tr> <tr> <td><code>on</code></td> <td><code>off</code></td> </tr> <tr> <td><code>+</code></td> <td><code>-</code></td> </tr> <tr> <td><code>1</code></td> <td><code>0</code></td> </tr> </tbody> </table> <div class=highlight><pre><span></span><code><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a>clp<span class=w> </span>--color<span class=w> </span><span class=nb>false</span><span class=w>           </span><span class=c1># disable color</span>
<a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a>clp<span class=w> </span>--raise-on-stale<span class=w> </span>yes<span class=w>    </span><span class=c1># enforce stale coverage failures</span>
</code></pre></div> <h3 id=-c-color-boolean><code>-C, --color BOOLEAN</code><a class=headerlink href=#-c-color-boolean title="Permanent link">&para;</a></h3> <p>Enable or disable ANSI color codes in source output. Requires an explicit boolean value.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a>clp<span class=w> </span>-s<span class=w> </span>uncovered<span class=w> </span>--color<span class=w> </span><span class=nb>true</span><span class=w> </span>uncovered<span class=w> </span>lib/api/client.rb
<a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a>clp<span class=w> </span>-s<span class=w> </span>uncovered<span class=w> </span>-C<span class=w> </span><span class=nb>false</span><span class=w> </span>uncovered<span class=w> </span>lib/api/client.rb
</code></pre></div> <p><strong>Default:</strong> Colors enabled if output is a TTY</p> <h3 id=-s-raise-on-stale-boolean><code>-S, --raise-on-stale BOOLEAN</code><a class=headerlink href=#-s-raise-on-stale-boolean title="Permanent link">&para;</a></h3> <p>Raise error if coverage is stale. Requires an explicit boolean value. Default is <code>false</code> (only report staleness in output).</p> <div class=highlight><pre><span></span><code><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a><span class=c1># Enable raising an error if coverage is stale</span>
<a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a>clp<span class=w> </span>-S<span class=w> </span><span class=nb>true</span>
<a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a>clp<span class=w> </span>--raise-on-stale<span class=w> </span>yes
<a id=__codelineno-28-4 name=__codelineno-28-4 href=#__codelineno-28-4></a>
<a id=__codelineno-28-5 name=__codelineno-28-5 href=#__codelineno-28-5></a><span class=c1># Explicitly disable raising an error (useful to override COV_LOUPE_OPTS)</span>
<a id=__codelineno-28-6 name=__codelineno-28-6 href=#__codelineno-28-6></a>clp<span class=w> </span>--raise-on-stale<span class=w> </span><span class=nb>false</span>
</code></pre></div> <p><strong>Staleness conditions:</strong> - <strong>"missing"</strong> (Missing): Source file no longer exists on disk - <strong>"newer"</strong> (Timestamp): Source file modified after coverage was generated - <strong>"length_mismatch"</strong> (Length): Source file line count differs from coverage data - <strong>"error"</strong> (Error): Staleness check failed due to permission or I/O errors - Tracked files missing from coverage (with --tracked-globs)</p> <h3 id=-g-tracked-globs-patterns><code>-g, --tracked-globs PATTERNS</code><a class=headerlink href=#-g-tracked-globs-patterns title="Permanent link">&para;</a></h3> <p>Comma-separated glob patterns for files that should be tracked.</p> <p><strong>Default:</strong> <code>[]</code> (empty - shows all files in the resultset)</p> <p><strong>Why no default patterns?</strong> 1. <strong>Transparency</strong> - Shows all coverage data without hiding files that don't match assumptions 2. <strong>Avoids false positives</strong> - Broad patterns like <code>**/*.rb</code> flag migrations, bin scripts, etc. as "missing" 3. <strong>Project variety</strong> - Coverage patterns vary by project structure (lib/, app/, src/, config/, etc.)</p> <p><strong>Important:</strong> Files lacking any coverage at all (not loaded during tests) will not appear in the resultset and therefore won't be visible with the default empty array. To detect such files, you must set <code>--tracked-globs</code> to match the files you expect to have coverage.</p> <p><strong>Best practice:</strong> Match your SimpleCov configuration by setting <code>COV_LOUPE_OPTS</code>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a><span class=c1># In spec_helper.rb or similar</span>
<a id=__codelineno-29-2 name=__codelineno-29-2 href=#__codelineno-29-2></a><span class=no>SimpleCov</span><span class=o>.</span><span class=n>start</span><span class=w> </span><span class=k>do</span>
<a id=__codelineno-29-3 name=__codelineno-29-3 href=#__codelineno-29-3></a><span class=w>  </span><span class=n>add_filter</span><span class=w> </span><span class=s1>&#39;/spec/&#39;</span>
<a id=__codelineno-29-4 name=__codelineno-29-4 href=#__codelineno-29-4></a><span class=w>  </span><span class=n>add_filter</span><span class=w> </span><span class=s1>&#39;/test/&#39;</span>
<a id=__codelineno-29-5 name=__codelineno-29-5 href=#__codelineno-29-5></a><span class=w>  </span><span class=n>track_files</span><span class=w> </span><span class=s1>&#39;lib/**/*.rb&#39;</span>
<a id=__codelineno-29-6 name=__codelineno-29-6 href=#__codelineno-29-6></a><span class=w>  </span><span class=n>track_files</span><span class=w> </span><span class=s1>&#39;app/**/*.rb&#39;</span>
<a id=__codelineno-29-7 name=__codelineno-29-7 href=#__codelineno-29-7></a><span class=k>end</span>
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a><span class=c1># In your shell config (.bashrc, .zshrc, etc.)</span>
<a id=__codelineno-30-2 name=__codelineno-30-2 href=#__codelineno-30-2></a><span class=c1># Match the track_files patterns above</span>
<a id=__codelineno-30-3 name=__codelineno-30-3 href=#__codelineno-30-3></a><span class=nb>export</span><span class=w> </span><span class=nv>COV_LOUPE_OPTS</span><span class=o>=</span><span class=s2>&quot;--tracked-globs lib/**/*.rb,app/**/*.rb&quot;</span>
</code></pre></div> <p><strong>Usage:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a><span class=c1># Use environment variable for project-wide default</span>
<a id=__codelineno-31-2 name=__codelineno-31-2 href=#__codelineno-31-2></a><span class=nb>export</span><span class=w> </span><span class=nv>COV_LOUPE_OPTS</span><span class=o>=</span><span class=s2>&quot;--tracked-globs lib/**/*.rb,app/**/*.rb&quot;</span>
<a id=__codelineno-31-3 name=__codelineno-31-3 href=#__codelineno-31-3></a>clp<span class=w> </span>list<span class=w>  </span><span class=c1># Uses globs from env var</span>
<a id=__codelineno-31-4 name=__codelineno-31-4 href=#__codelineno-31-4></a>
<a id=__codelineno-31-5 name=__codelineno-31-5 href=#__codelineno-31-5></a><span class=c1># Or specify per-command</span>
<a id=__codelineno-31-6 name=__codelineno-31-6 href=#__codelineno-31-6></a>clp<span class=w> </span>-g<span class=w> </span><span class=s2>&quot;lib/api/**/*.rb&quot;</span><span class=w> </span>list
<a id=__codelineno-31-7 name=__codelineno-31-7 href=#__codelineno-31-7></a>
<a id=__codelineno-31-8 name=__codelineno-31-8 href=#__codelineno-31-8></a><span class=c1># Multiple patterns</span>
<a id=__codelineno-31-9 name=__codelineno-31-9 href=#__codelineno-31-9></a>clp<span class=w> </span>-g<span class=w> </span><span class=s2>&quot;lib/**/*.rb,app/models/**/*.rb&quot;</span><span class=w> </span>list
<a id=__codelineno-31-10 name=__codelineno-31-10 href=#__codelineno-31-10></a>
<a id=__codelineno-31-11 name=__codelineno-31-11 href=#__codelineno-31-11></a><span class=c1># Export for CI (with globs to match SimpleCov)</span>
<a id=__codelineno-31-12 name=__codelineno-31-12 href=#__codelineno-31-12></a>clp<span class=w> </span>-g<span class=w> </span><span class=s2>&quot;lib/**/*.rb,app/**/*.rb&quot;</span><span class=w> </span>-fp<span class=w> </span>list<span class=w> </span>&gt;<span class=w> </span>coverage.json
</code></pre></div> <p><strong>Use cases:</strong> - <strong>Exclude unwanted results</strong> - Narrow focus to a subsystem or layer - <strong>Include files without coverage</strong> - Report files that should be tracked but aren't in the resultset - <strong>CI validation</strong> - Use with <code>-S</code>/<code>--raise-on-stale</code> to catch coverage gaps</p> <p><strong>Important:</strong> The <code>missing_tracked_files</code> array (in <code>list</code> output) only includes files that: 1. Match the tracked globs 2. Exist in the filesystem 3. Are NOT in the coverage resultset</p> <p>Without globs, this array is empty (no expectations = no violations).</p> <h3 id=-l-log-file-path><code>-l, --log-file PATH</code><a class=headerlink href=#-l-log-file-path title="Permanent link">&para;</a></h3> <p>Log file location. Use 'stdout' or 'stderr' to log to standard streams.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a>clp<span class=w> </span>-l<span class=w> </span>/var/log/simplecov.log<span class=w>  </span><span class=c1># -l = --log-file</span>
<a id=__codelineno-32-2 name=__codelineno-32-2 href=#__codelineno-32-2></a>clp<span class=w> </span>-l<span class=w> </span>stdout<span class=w>                   </span><span class=c1># Log to standard output</span>
<a id=__codelineno-32-3 name=__codelineno-32-3 href=#__codelineno-32-3></a>clp<span class=w> </span>-l<span class=w> </span>stderr<span class=w>                   </span><span class=c1># Log to standard error</span>
</code></pre></div> <p><strong>Default:</strong> <code>./cov_loupe.log</code></p> <p><strong>Warning:</strong> Log files may grow unbounded in long-running or CI usage. Consider using a log rotation tool or periodically cleaning up the log file if this is a concern.</p> <h3 id=-e-error-mode-mode><code>-e, --error-mode MODE</code><a class=headerlink href=#-e-error-mode-mode title="Permanent link">&para;</a></h3> <p>Error handling verbosity.</p> <p><strong>Modes:</strong></p> <table> <thead> <tr> <th>Short</th> <th>Long</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td></td> <td><code>off</code></td> <td>Silent (no error logging)</td> </tr> <tr> <td><code>l</code></td> <td><code>log</code></td> <td>Log errors without stack traces (default)</td> </tr> <tr> <td><code>d</code></td> <td><code>debug</code></td> <td>Log errors with full stack traces</td> </tr> </tbody> </table> <div class=highlight><pre><span></span><code><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a>clp<span class=w> </span>--error-mode<span class=w> </span>debug<span class=w> </span>summary<span class=w> </span>lib/api/client.rb
<a id=__codelineno-33-2 name=__codelineno-33-2 href=#__codelineno-33-2></a>clp<span class=w> </span>-e<span class=w> </span>debug<span class=w> </span>summary<span class=w> </span>lib/api/client.rb<span class=w>  </span><span class=c1># -e = --error-mode</span>
<a id=__codelineno-33-3 name=__codelineno-33-3 href=#__codelineno-33-3></a>clp<span class=w> </span>-edebug<span class=w> </span>summary<span class=w> </span>lib/api/client.rb<span class=w>   </span><span class=c1># attached short option form</span>
</code></pre></div> <h3 id=-o-output-chars-mode><code>-O, --output-chars MODE</code><a class=headerlink href=#-o-output-chars-mode title="Permanent link">&para;</a></h3> <p>Control output character encoding for ASCII-only environments.</p> <p><strong>Modes:</strong></p> <table> <thead> <tr> <th>Short</th> <th>Long</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>d</code></td> <td><code>default</code></td> <td>Auto-detect terminal UTF-8 support (default)</td> </tr> <tr> <td><code>f</code></td> <td><code>fancy</code></td> <td>Force Unicode output with box-drawing characters</td> </tr> <tr> <td><code>a</code></td> <td><code>ascii</code></td> <td>Force ASCII-only output with transliteration</td> </tr> </tbody> </table> <div class=highlight><pre><span></span><code><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a><span class=c1># Default mode (auto-detect)</span>
<a id=__codelineno-34-2 name=__codelineno-34-2 href=#__codelineno-34-2></a>clp<span class=w> </span>list
<a id=__codelineno-34-3 name=__codelineno-34-3 href=#__codelineno-34-3></a>
<a id=__codelineno-34-4 name=__codelineno-34-4 href=#__codelineno-34-4></a><span class=c1># Force ASCII mode (for legacy terminals or CI)</span>
<a id=__codelineno-34-5 name=__codelineno-34-5 href=#__codelineno-34-5></a>clp<span class=w> </span>-O<span class=w> </span>ascii<span class=w> </span>list
<a id=__codelineno-34-6 name=__codelineno-34-6 href=#__codelineno-34-6></a>clp<span class=w> </span>-O<span class=w> </span>a<span class=w> </span>list<span class=w>  </span><span class=c1># a = ascii</span>
<a id=__codelineno-34-7 name=__codelineno-34-7 href=#__codelineno-34-7></a>
<a id=__codelineno-34-8 name=__codelineno-34-8 href=#__codelineno-34-8></a><span class=c1># Force fancy mode (Unicode characters)</span>
<a id=__codelineno-34-9 name=__codelineno-34-9 href=#__codelineno-34-9></a>clp<span class=w> </span>-O<span class=w> </span>fancy<span class=w> </span>list
<a id=__codelineno-34-10 name=__codelineno-34-10 href=#__codelineno-34-10></a>clp<span class=w> </span>-O<span class=w> </span>f<span class=w> </span>list<span class=w>  </span><span class=c1># f = fancy</span>
</code></pre></div> <p><strong>What gets converted in ASCII mode:</strong> - Table borders (│ ─ ┌ ┐ └ ┘ ├ ┤ ┬ ┴ ┼ → | - + + + + + + + + +) - Source code markers (✓ · → + -) - Error messages and file paths - All formatted output (tables, source, JSON, YAML)</p> <p><strong>What does NOT get converted:</strong> - Log files (preserved in original encoding for debugging fidelity) - Gem post-install message</p> <p><strong>Use cases:</strong> - <strong>CI/CD systems</strong> with ASCII-only terminals: <code>clp -O ascii list</code> - <strong>Windows</strong> with legacy encoding: <code>clp -O ascii summary lib/api/client.rb</code> - <strong>Piped output</strong> to files: <code>clp -O ascii list &gt; coverage.txt</code> - <strong>Force Unicode</strong> even if terminal detection fails: <code>clp -O fancy list</code></p> <p><strong>Note:</strong> The default mode auto-detects whether your terminal supports UTF-8. If Unicode characters appear garbled or as question marks, try <code>clp -O ascii</code>.</p> <h3 id=-m-mode-mode><code>-m, --mode MODE</code><a class=headerlink href=#-m-mode-mode title="Permanent link">&para;</a></h3> <p>Specify execution mode: <code>cli</code> or <code>mcp</code> (default: <code>cli</code>). Use <code>--mode mcp</code> to run as an MCP server. In v4.0.0+, automatic mode detection was removed; you must explicitly specify <code>--mode mcp</code> to run the MCP server.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-35-1 name=__codelineno-35-1 href=#__codelineno-35-1></a>clp<span class=w> </span>-m<span class=w> </span>mcp<span class=w>               </span><span class=c1># MCP server mode (required for MCP), short option form</span>
<a id=__codelineno-35-2 name=__codelineno-35-2 href=#__codelineno-35-2></a>clp<span class=w> </span>--mode<span class=w> </span>mcp<span class=w>           </span><span class=c1># MCP server mode (required for MCP), long option form</span>
<a id=__codelineno-35-3 name=__codelineno-35-3 href=#__codelineno-35-3></a>clp<span class=w> </span>-m<span class=w> </span>cli<span class=w> </span>list<span class=w>          </span><span class=c1># CLI mode (default), can use to override environment variable</span>
</code></pre></div> <h3 id=validate-subcommand><code>validate</code> Subcommand<a class=headerlink href=#validate-subcommand title="Permanent link">&para;</a></h3> <p>Validate coverage against custom policies for CI/CD enforcement.</p> <blockquote> <p><strong>⚠️ SECURITY WARNING</strong></p> <p>Validation predicates execute as <strong>arbitrary Ruby code with full system privileges</strong>. They have unrestricted access to file system, network, system commands, and environment variables.</p> <p><strong>Only use predicate files from trusted sources.</strong> Review predicates before use, especially in CI/CD environments.</p> </blockquote> <p>The predicate must be a callable (lambda, proc, or object with <code>#call</code> method) that receives a <code>CoverageModel</code> and returns <code>true</code> or <code>false</code>.</p> <p><strong>Predicate return values:</strong> - <code>true</code> - Coverage meets your criteria (CLI exits with code 0) - <code>false</code> - Coverage fails your criteria (CLI exits with code 1) - Exception raised - Predicate error (CLI exits with code 2)</p> <p><strong>File mode (most common):</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-36-1 name=__codelineno-36-1 href=#__codelineno-36-1></a><span class=c1># Use example predicate</span>
<a id=__codelineno-36-2 name=__codelineno-36-2 href=#__codelineno-36-2></a>clp<span class=w> </span>validate<span class=w> </span>examples/success_predicates/all_files_above_threshold_predicate.rb
<a id=__codelineno-36-3 name=__codelineno-36-3 href=#__codelineno-36-3></a>
<a id=__codelineno-36-4 name=__codelineno-36-4 href=#__codelineno-36-4></a><span class=c1># In CI/CD</span>
<a id=__codelineno-36-5 name=__codelineno-36-5 href=#__codelineno-36-5></a>bundle<span class=w> </span><span class=nb>exec</span><span class=w> </span>cov-loupe<span class=w> </span>validate<span class=w> </span>coverage_policy.rb
</code></pre></div></p> <p><strong>String mode (inline code):</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-37-1 name=__codelineno-37-1 href=#__codelineno-37-1></a><span class=c1># Simple inline validation</span>
<a id=__codelineno-37-2 name=__codelineno-37-2 href=#__codelineno-37-2></a>clp<span class=w> </span>validate<span class=w> </span>-i<span class=w> </span><span class=s1>&#39;-&gt;(m) { m.list.all? { |f| f[&quot;percentage&quot;] &gt;= 80 } }&#39;</span>
<a id=__codelineno-37-3 name=__codelineno-37-3 href=#__codelineno-37-3></a>
<a id=__codelineno-37-4 name=__codelineno-37-4 href=#__codelineno-37-4></a><span class=c1># With global options</span>
<a id=__codelineno-37-5 name=__codelineno-37-5 href=#__codelineno-37-5></a>clp<span class=w> </span>-r<span class=w> </span>coverage<span class=w> </span>validate<span class=w> </span>-i<span class=w> </span><span class=s1>&#39;-&gt;(m) { m.list.size &gt; 0 }&#39;</span>
</code></pre></div></p> <p><strong>Example predicate file:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-38-1 name=__codelineno-38-1 href=#__codelineno-38-1></a><span class=c1># coverage_policy.rb</span>
<a id=__codelineno-38-2 name=__codelineno-38-2 href=#__codelineno-38-2></a><span class=o>-&gt;</span><span class=p>(</span><span class=n>model</span><span class=p>)</span><span class=w> </span><span class=k>do</span>
<a id=__codelineno-38-3 name=__codelineno-38-3 href=#__codelineno-38-3></a><span class=w>  </span><span class=n>model</span><span class=o>.</span><span class=n>list</span><span class=o>.</span><span class=n>all?</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=o>|</span><span class=n>f</span><span class=o>|</span><span class=w> </span><span class=n>f</span><span class=o>[</span><span class=s1>&#39;percentage&#39;</span><span class=o>]</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>80</span><span class=w> </span><span class=p>}</span>
<a id=__codelineno-38-4 name=__codelineno-38-4 href=#__codelineno-38-4></a><span class=k>end</span>
</code></pre></div></p> <p>See <a href=../../examples/success_predicates/ >examples/success_predicates/</a> for more examples.</p> <h2 id=output-formats>Output Formats<a class=headerlink href=#output-formats title="Permanent link">&para;</a></h2> <h3 id=table-format>Table Format<a class=headerlink href=#table-format title="Permanent link">&para;</a></h3> <p>Default for <code>list</code> subcommand. Uses Unicode box-drawing characters.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-39-1 name=__codelineno-39-1 href=#__codelineno-39-1></a>┌──────────────────────────────────┬──────────┬───────────┬─────────┬───────┐
<a id=__codelineno-39-2 name=__codelineno-39-2 href=#__codelineno-39-2></a>│ File                             │        % │   Covered │   Total │ Stale │
<a id=__codelineno-39-3 name=__codelineno-39-3 href=#__codelineno-39-3></a>├──────────────────────────────────┼──────────┼───────────┼─────────┼───────┤
<a id=__codelineno-39-4 name=__codelineno-39-4 href=#__codelineno-39-4></a>│ lib/payments/refund_service.rb   │   60.00% │         3 │       5 │       │
<a id=__codelineno-39-5 name=__codelineno-39-5 href=#__codelineno-39-5></a>└──────────────────────────────────┴──────────┴───────────┴─────────┴───────┘
</code></pre></div> <h3 id=json-format>JSON Format<a class=headerlink href=#json-format title="Permanent link">&para;</a></h3> <p>Machine-readable output. Paths are relative to project root.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-40-1 name=__codelineno-40-1 href=#__codelineno-40-1></a><span class=p>{</span>
<a id=__codelineno-40-2 name=__codelineno-40-2 href=#__codelineno-40-2></a><span class=w>  </span><span class=nt>&quot;file&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;app/models/order.rb&quot;</span><span class=p>,</span>
<a id=__codelineno-40-3 name=__codelineno-40-3 href=#__codelineno-40-3></a><span class=w>  </span><span class=nt>&quot;summary&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-40-4 name=__codelineno-40-4 href=#__codelineno-40-4></a><span class=w>    </span><span class=nt>&quot;covered&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>6</span><span class=p>,</span>
<a id=__codelineno-40-5 name=__codelineno-40-5 href=#__codelineno-40-5></a><span class=w>    </span><span class=nt>&quot;total&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>7</span><span class=p>,</span>
<a id=__codelineno-40-6 name=__codelineno-40-6 href=#__codelineno-40-6></a><span class=w>    </span><span class=nt>&quot;percentage&quot;</span><span class=p>:</span><span class=w> </span><span class=mf>85.71</span>
<a id=__codelineno-40-7 name=__codelineno-40-7 href=#__codelineno-40-7></a><span class=w>  </span><span class=p>},</span>
<a id=__codelineno-40-8 name=__codelineno-40-8 href=#__codelineno-40-8></a><span class=w>  </span><span class=nt>&quot;stale&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;ok&quot;</span>
<a id=__codelineno-40-9 name=__codelineno-40-9 href=#__codelineno-40-9></a><span class=p>}</span>
</code></pre></div> <p><strong>Staleness values:</strong> - <code>"ok"</code> - Coverage data is current - <code>"missing"</code> - File missing (no longer exists on disk) - <code>"newer"</code> - Timestamp mismatch (file modified after coverage) - <code>"length_mismatch"</code> - Length mismatch (line count differs)</p> <h3 id=source-display>Source Display<a class=headerlink href=#source-display title="Permanent link">&para;</a></h3> <p>With <code>--source</code> flag, shows annotated source code:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-41-1 name=__codelineno-41-1 href=#__codelineno-41-1></a>  Line     | Source
<a id=__codelineno-41-2 name=__codelineno-41-2 href=#__codelineno-41-2></a>  ------+-----------------------------------------------------------
<a id=__codelineno-41-3 name=__codelineno-41-3 href=#__codelineno-41-3></a>     1  ✓ | class User
<a id=__codelineno-41-4 name=__codelineno-41-4 href=#__codelineno-41-4></a>     2  · |   def initialize  # Not covered
<a id=__codelineno-41-5 name=__codelineno-41-5 href=#__codelineno-41-5></a>     3  ✓ |     # ...
</code></pre></div> <h2 id=environment-variables>Environment Variables<a class=headerlink href=#environment-variables title="Permanent link">&para;</a></h2> <h3 id=cov_loupe_opts><code>COV_LOUPE_OPTS</code><a class=headerlink href=#cov_loupe_opts title="Permanent link">&para;</a></h3> <p>Default command-line options applied to all invocations.</p> <p><strong>Format:</strong> Shell-style string containing any valid CLI options</p> <div class=highlight><pre><span></span><code><a id=__codelineno-42-1 name=__codelineno-42-1 href=#__codelineno-42-1></a><span class=nb>export</span><span class=w> </span><span class=nv>COV_LOUPE_OPTS</span><span class=o>=</span><span class=s2>&quot;--resultset coverage -fp&quot;</span>
<a id=__codelineno-42-2 name=__codelineno-42-2 href=#__codelineno-42-2></a>clp<span class=w> </span>summary<span class=w> </span>lib/api/client.rb<span class=w>  </span><span class=c1># Automatically uses options above</span>
</code></pre></div> <p><strong>Precedence:</strong> Command-line arguments override environment options</p> <div class=highlight><pre><span></span><code><a id=__codelineno-43-1 name=__codelineno-43-1 href=#__codelineno-43-1></a><span class=c1># Environment sets -fp; explicit CLI options still take precedence</span>
<a id=__codelineno-43-2 name=__codelineno-43-2 href=#__codelineno-43-2></a><span class=nb>export</span><span class=w> </span><span class=nv>COV_LOUPE_OPTS</span><span class=o>=</span><span class=s2>&quot;-fp&quot;</span>
<a id=__codelineno-43-3 name=__codelineno-43-3 href=#__codelineno-43-3></a>clp<span class=w> </span>summary<span class=w> </span>lib/api/client.rb<span class=w>  </span><span class=c1># Uses JSON (from env)</span>
<a id=__codelineno-43-4 name=__codelineno-43-4 href=#__codelineno-43-4></a>clp<span class=w> </span>-f<span class=w> </span>table<span class=w> </span>summary<span class=w> </span>lib/api/client.rb<span class=w>  </span><span class=c1># Explicit override to table format</span>
</code></pre></div> <p><strong>Examples:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-44-1 name=__codelineno-44-1 href=#__codelineno-44-1></a><span class=c1># Default resultset location</span>
<a id=__codelineno-44-2 name=__codelineno-44-2 href=#__codelineno-44-2></a><span class=nb>export</span><span class=w> </span><span class=nv>COV_LOUPE_OPTS</span><span class=o>=</span><span class=s2>&quot;-r build/coverage&quot;</span>
<a id=__codelineno-44-3 name=__codelineno-44-3 href=#__codelineno-44-3></a>
<a id=__codelineno-44-4 name=__codelineno-44-4 href=#__codelineno-44-4></a><span class=c1># Enable detailed error logging</span>
<a id=__codelineno-44-5 name=__codelineno-44-5 href=#__codelineno-44-5></a><span class=nb>export</span><span class=w> </span><span class=nv>COV_LOUPE_OPTS</span><span class=o>=</span><span class=s2>&quot;--error-mode debug&quot;</span>
<a id=__codelineno-44-6 name=__codelineno-44-6 href=#__codelineno-44-6></a>
<a id=__codelineno-44-7 name=__codelineno-44-7 href=#__codelineno-44-7></a><span class=c1># Paths with spaces</span>
<a id=__codelineno-44-8 name=__codelineno-44-8 href=#__codelineno-44-8></a><span class=nb>export</span><span class=w> </span><span class=nv>COV_LOUPE_OPTS</span><span class=o>=</span><span class=s1>&#39;-r &quot;/path with spaces/coverage&quot;&#39;</span>
<a id=__codelineno-44-9 name=__codelineno-44-9 href=#__codelineno-44-9></a>
<a id=__codelineno-44-10 name=__codelineno-44-10 href=#__codelineno-44-10></a><span class=c1># Multiple options</span>
<a id=__codelineno-44-11 name=__codelineno-44-11 href=#__codelineno-44-11></a><span class=nb>export</span><span class=w> </span><span class=nv>COV_LOUPE_OPTS</span><span class=o>=</span><span class=s2>&quot;-r coverage -S -fp&quot;</span>
</code></pre></div></p> <h2 id=examples>Examples<a class=headerlink href=#examples title="Permanent link">&para;</a></h2> <h3 id=basic-coverage-check>Basic Coverage Check<a class=headerlink href=#basic-coverage-check title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-45-1 name=__codelineno-45-1 href=#__codelineno-45-1></a><span class=c1># Show all files sorted by highest coverage first (default)</span>
<a id=__codelineno-45-2 name=__codelineno-45-2 href=#__codelineno-45-2></a>clp
<a id=__codelineno-45-3 name=__codelineno-45-3 href=#__codelineno-45-3></a>
<a id=__codelineno-45-4 name=__codelineno-45-4 href=#__codelineno-45-4></a><span class=c1># Find the 5 files with worst coverage (account for header/footer)</span>
<a id=__codelineno-45-5 name=__codelineno-45-5 href=#__codelineno-45-5></a>clp<span class=w> </span>list<span class=w> </span><span class=p>|</span><span class=w> </span>tail<span class=w> </span>-7
</code></pre></div> <h3 id=detailed-file-investigation>Detailed File Investigation<a class=headerlink href=#detailed-file-investigation title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-46-1 name=__codelineno-46-1 href=#__codelineno-46-1></a><span class=c1># Check a specific file</span>
<a id=__codelineno-46-2 name=__codelineno-46-2 href=#__codelineno-46-2></a>clp<span class=w> </span>summary<span class=w> </span>lib/payments/refund_service.rb
<a id=__codelineno-46-3 name=__codelineno-46-3 href=#__codelineno-46-3></a>
<a id=__codelineno-46-4 name=__codelineno-46-4 href=#__codelineno-46-4></a><span class=c1># See which lines aren&#39;t covered</span>
<a id=__codelineno-46-5 name=__codelineno-46-5 href=#__codelineno-46-5></a>clp<span class=w> </span>uncovered<span class=w> </span>lib/payments/refund_service.rb
<a id=__codelineno-46-6 name=__codelineno-46-6 href=#__codelineno-46-6></a>
<a id=__codelineno-46-7 name=__codelineno-46-7 href=#__codelineno-46-7></a><span class=c1># View uncovered code in context</span>
<a id=__codelineno-46-8 name=__codelineno-46-8 href=#__codelineno-46-8></a>clp<span class=w> </span>-s<span class=w> </span>uncovered<span class=w> </span>-c<span class=w> </span><span class=m>3</span><span class=w> </span>uncovered<span class=w> </span>lib/payments/refund_service.rb
<a id=__codelineno-46-9 name=__codelineno-46-9 href=#__codelineno-46-9></a>
<a id=__codelineno-46-10 name=__codelineno-46-10 href=#__codelineno-46-10></a><span class=c1># Get detailed hit counts</span>
<a id=__codelineno-46-11 name=__codelineno-46-11 href=#__codelineno-46-11></a>clp<span class=w> </span>detailed<span class=w> </span>lib/payments/refund_service.rb
</code></pre></div> <h3 id=json-output-for-scripts>JSON Output for Scripts<a class=headerlink href=#json-output-for-scripts title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-47-1 name=__codelineno-47-1 href=#__codelineno-47-1></a><span class=c1># Get JSON for parsing</span>
<a id=__codelineno-47-2 name=__codelineno-47-2 href=#__codelineno-47-2></a>clp<span class=w> </span>-fp<span class=w> </span>list<span class=w> </span>&gt;<span class=w> </span>coverage.json
<a id=__codelineno-47-3 name=__codelineno-47-3 href=#__codelineno-47-3></a>
<a id=__codelineno-47-4 name=__codelineno-47-4 href=#__codelineno-47-4></a><span class=c1># Extract files below threshold</span>
<a id=__codelineno-47-5 name=__codelineno-47-5 href=#__codelineno-47-5></a>clp<span class=w> </span>-fp<span class=w> </span>list<span class=w> </span><span class=p>|</span><span class=w> </span>jq<span class=w> </span><span class=s1>&#39;.files[] | select(.percentage &lt; 80)&#39;</span>
<a id=__codelineno-47-6 name=__codelineno-47-6 href=#__codelineno-47-6></a>
<a id=__codelineno-47-7 name=__codelineno-47-7 href=#__codelineno-47-7></a><span class=c1># Ruby alternative:</span>
<a id=__codelineno-47-8 name=__codelineno-47-8 href=#__codelineno-47-8></a>clp<span class=w> </span>-fp<span class=w> </span>list<span class=w> </span><span class=p>|</span><span class=w> </span>ruby<span class=w> </span>-r<span class=w> </span>json<span class=w> </span>-e<span class=w> </span><span class=s1>&#39;</span>
<a id=__codelineno-47-9 name=__codelineno-47-9 href=#__codelineno-47-9></a><span class=s1>  JSON.parse($stdin.read)[&quot;files&quot;].select { |f| f[&quot;percentage&quot;] &lt; 80 }.each do |f|</span>
<a id=__codelineno-47-10 name=__codelineno-47-10 href=#__codelineno-47-10></a><span class=s1>    puts JSON.pretty_generate(f)</span>
<a id=__codelineno-47-11 name=__codelineno-47-11 href=#__codelineno-47-11></a><span class=s1>  end</span>
<a id=__codelineno-47-12 name=__codelineno-47-12 href=#__codelineno-47-12></a><span class=s1>&#39;</span>
<a id=__codelineno-47-13 name=__codelineno-47-13 href=#__codelineno-47-13></a>
<a id=__codelineno-47-14 name=__codelineno-47-14 href=#__codelineno-47-14></a><span class=c1># Rexe alternative:</span>
<a id=__codelineno-47-15 name=__codelineno-47-15 href=#__codelineno-47-15></a>clp<span class=w> </span>-fp<span class=w> </span>list<span class=w> </span><span class=p>|</span><span class=w> </span>rexe<span class=w> </span>-ij<span class=w> </span>-mb<span class=w> </span>-oJ<span class=w> </span><span class=s1>&#39;self[&quot;files&quot;].select { |f| f[&quot;percentage&quot;] &lt; 80 }&#39;</span>
<a id=__codelineno-47-16 name=__codelineno-47-16 href=#__codelineno-47-16></a>
<a id=__codelineno-47-17 name=__codelineno-47-17 href=#__codelineno-47-17></a><span class=c1># Count files below 80% coverage</span>
<a id=__codelineno-47-18 name=__codelineno-47-18 href=#__codelineno-47-18></a>clp<span class=w> </span>-fp<span class=w> </span>list<span class=w> </span><span class=p>|</span><span class=w> </span>jq<span class=w> </span><span class=s1>&#39;[.files[] | select(.percentage &lt; 80)] | length&#39;</span>
<a id=__codelineno-47-19 name=__codelineno-47-19 href=#__codelineno-47-19></a>
<a id=__codelineno-47-20 name=__codelineno-47-20 href=#__codelineno-47-20></a><span class=c1># Ruby alternative:</span>
<a id=__codelineno-47-21 name=__codelineno-47-21 href=#__codelineno-47-21></a>clp<span class=w> </span>-fp<span class=w> </span>list<span class=w> </span><span class=p>|</span><span class=w> </span>ruby<span class=w> </span>-r<span class=w> </span>json<span class=w> </span>-e<span class=w> </span><span class=s1>&#39;</span>
<a id=__codelineno-47-22 name=__codelineno-47-22 href=#__codelineno-47-22></a><span class=s1>  puts JSON.parse($stdin.read)[&quot;files&quot;].count { |f| f[&quot;percentage&quot;] &lt; 80 }</span>
<a id=__codelineno-47-23 name=__codelineno-47-23 href=#__codelineno-47-23></a><span class=s1>&#39;</span>
<a id=__codelineno-47-24 name=__codelineno-47-24 href=#__codelineno-47-24></a>
<a id=__codelineno-47-25 name=__codelineno-47-25 href=#__codelineno-47-25></a><span class=c1># Rexe alternative:</span>
<a id=__codelineno-47-26 name=__codelineno-47-26 href=#__codelineno-47-26></a>clp<span class=w> </span>-fp<span class=w> </span>list<span class=w> </span><span class=p>|</span><span class=w> </span>rexe<span class=w> </span>-ij<span class=w> </span>-mb<span class=w> </span>-op<span class=w> </span><span class=s1>&#39;self[&quot;files&quot;].count { |f| f[&quot;percentage&quot;] &lt; 80 }&#39;</span>
</code></pre></div> <h3 id=filtering-and-sorting>Filtering and Sorting<a class=headerlink href=#filtering-and-sorting title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-48-1 name=__codelineno-48-1 href=#__codelineno-48-1></a><span class=c1># Show only lib/ files</span>
<a id=__codelineno-48-2 name=__codelineno-48-2 href=#__codelineno-48-2></a>clp<span class=w> </span>-g<span class=w> </span><span class=s2>&quot;lib/**/*.rb&quot;</span><span class=w> </span>list
<a id=__codelineno-48-3 name=__codelineno-48-3 href=#__codelineno-48-3></a>
<a id=__codelineno-48-4 name=__codelineno-48-4 href=#__codelineno-48-4></a><span class=c1># Show files sorted by highest coverage</span>
<a id=__codelineno-48-5 name=__codelineno-48-5 href=#__codelineno-48-5></a>clp<span class=w> </span>-o<span class=w> </span>d<span class=w> </span>list
<a id=__codelineno-48-6 name=__codelineno-48-6 href=#__codelineno-48-6></a>
<a id=__codelineno-48-7 name=__codelineno-48-7 href=#__codelineno-48-7></a><span class=c1># Check specific directory</span>
<a id=__codelineno-48-8 name=__codelineno-48-8 href=#__codelineno-48-8></a>clp<span class=w> </span>-g<span class=w> </span><span class=s2>&quot;lib/payments/**/*.rb&quot;</span><span class=w> </span>list
</code></pre></div> <h3 id=staleness-checking>Staleness Checking<a class=headerlink href=#staleness-checking title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-49-1 name=__codelineno-49-1 href=#__codelineno-49-1></a><span class=c1># Check if coverage is stale (for CI/CD)</span>
<a id=__codelineno-49-2 name=__codelineno-49-2 href=#__codelineno-49-2></a>clp<span class=w> </span>-S<span class=w> </span><span class=nb>true</span>
<a id=__codelineno-49-3 name=__codelineno-49-3 href=#__codelineno-49-3></a>
<a id=__codelineno-49-4 name=__codelineno-49-4 href=#__codelineno-49-4></a><span class=c1># Check with specific file patterns</span>
<a id=__codelineno-49-5 name=__codelineno-49-5 href=#__codelineno-49-5></a>clp<span class=w> </span>-S<span class=w> </span><span class=nb>true</span><span class=w> </span>-g<span class=w> </span><span class=s2>&quot;lib/payments/**/*.rb,lib/ops/jobs/**/*.rb&quot;</span><span class=w> </span>list
<a id=__codelineno-49-6 name=__codelineno-49-6 href=#__codelineno-49-6></a>
<a id=__codelineno-49-7 name=__codelineno-49-7 href=#__codelineno-49-7></a><span class=c1># See which files are stale (don&#39;t error)</span>
<a id=__codelineno-49-8 name=__codelineno-49-8 href=#__codelineno-49-8></a>clp<span class=w> </span>list<span class=w>  </span><span class=c1># Stale column shows missing/newer/length_mismatch/error markers</span>
</code></pre></div> <h3 id=source-code-display>Source Code Display<a class=headerlink href=#source-code-display title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-50-1 name=__codelineno-50-1 href=#__codelineno-50-1></a><span class=c1># Show full source with coverage markers</span>
<a id=__codelineno-50-2 name=__codelineno-50-2 href=#__codelineno-50-2></a>clp<span class=w> </span>-s<span class=w> </span>full<span class=w> </span>summary<span class=w> </span>lib/api/client.rb
<a id=__codelineno-50-3 name=__codelineno-50-3 href=#__codelineno-50-3></a>
<a id=__codelineno-50-4 name=__codelineno-50-4 href=#__codelineno-50-4></a><span class=c1># Show only uncovered lines with context</span>
<a id=__codelineno-50-5 name=__codelineno-50-5 href=#__codelineno-50-5></a>clp<span class=w> </span>-s<span class=w> </span>uncovered<span class=w> </span>uncovered<span class=w> </span>lib/api/client.rb
<a id=__codelineno-50-6 name=__codelineno-50-6 href=#__codelineno-50-6></a>
<a id=__codelineno-50-7 name=__codelineno-50-7 href=#__codelineno-50-7></a><span class=c1># More context around uncovered code</span>
<a id=__codelineno-50-8 name=__codelineno-50-8 href=#__codelineno-50-8></a>clp<span class=w> </span>-s<span class=w> </span>uncovered<span class=w> </span>-c<span class=w> </span><span class=m>5</span><span class=w> </span>uncovered<span class=w> </span>lib/api/client.rb
<a id=__codelineno-50-9 name=__codelineno-50-9 href=#__codelineno-50-9></a>
<a id=__codelineno-50-10 name=__codelineno-50-10 href=#__codelineno-50-10></a><span class=c1># Without colors (for logging)</span>
<a id=__codelineno-50-11 name=__codelineno-50-11 href=#__codelineno-50-11></a>clp<span class=w> </span>-s<span class=w> </span>full<span class=w> </span>--color<span class=w> </span><span class=nb>false</span><span class=w> </span>uncovered<span class=w> </span>lib/api/client.rb
</code></pre></div> <h3 id=cicd-integration>CI/CD Integration<a class=headerlink href=#cicd-integration title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-51-1 name=__codelineno-51-1 href=#__codelineno-51-1></a><span class=c1># Fail build if coverage is stale</span>
<a id=__codelineno-51-2 name=__codelineno-51-2 href=#__codelineno-51-2></a>clp<span class=w> </span>-S<span class=w> </span><span class=nb>true</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=nb>exit</span><span class=w> </span><span class=m>1</span>
<a id=__codelineno-51-3 name=__codelineno-51-3 href=#__codelineno-51-3></a>
<a id=__codelineno-51-4 name=__codelineno-51-4 href=#__codelineno-51-4></a><span class=c1># Generate JSON report for artifact</span>
<a id=__codelineno-51-5 name=__codelineno-51-5 href=#__codelineno-51-5></a>clp<span class=w> </span>-fp<span class=w> </span>list<span class=w> </span>&gt;<span class=w> </span>artifacts/coverage-report.json
<a id=__codelineno-51-6 name=__codelineno-51-6 href=#__codelineno-51-6></a>
<a id=__codelineno-51-7 name=__codelineno-51-7 href=#__codelineno-51-7></a><span class=c1># Check specific directory in monorepo</span>
<a id=__codelineno-51-8 name=__codelineno-51-8 href=#__codelineno-51-8></a>clp<span class=w> </span>-R<span class=w> </span>services/api<span class=w> </span>-r<span class=w> </span>services/api/coverage<span class=w>  </span><span class=c1># -R = --root, -r = --resultset</span>
</code></pre></div> <h3 id=debugging>Debugging<a class=headerlink href=#debugging title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-52-1 name=__codelineno-52-1 href=#__codelineno-52-1></a><span class=c1># Verbose error output</span>
<a id=__codelineno-52-2 name=__codelineno-52-2 href=#__codelineno-52-2></a>clp<span class=w> </span>--error-mode<span class=w> </span>debug<span class=w> </span>summary<span class=w> </span>lib/api/client.rb
<a id=__codelineno-52-3 name=__codelineno-52-3 href=#__codelineno-52-3></a>
<a id=__codelineno-52-4 name=__codelineno-52-4 href=#__codelineno-52-4></a><span class=c1># Custom log file (--log-file or -l)</span>
<a id=__codelineno-52-5 name=__codelineno-52-5 href=#__codelineno-52-5></a>clp<span class=w> </span>-l<span class=w> </span>/tmp/simplecov-debug.log<span class=w> </span>summary<span class=w> </span>lib/api/client.rb
<a id=__codelineno-52-6 name=__codelineno-52-6 href=#__codelineno-52-6></a>
<a id=__codelineno-52-7 name=__codelineno-52-7 href=#__codelineno-52-7></a><span class=c1># Check what resultset is being used</span>
<a id=__codelineno-52-8 name=__codelineno-52-8 href=#__codelineno-52-8></a>clp<span class=w> </span>--error-mode<span class=w> </span>debug<span class=w> </span><span class=m>2</span>&gt;<span class=p>&amp;</span><span class=m>1</span><span class=w> </span><span class=p>|</span><span class=w> </span>grep<span class=w> </span>resultset
</code></pre></div> <h2 id=exit-codes>Exit Codes<a class=headerlink href=#exit-codes title="Permanent link">&para;</a></h2> <ul> <li><code>0</code> - Success</li> <li><code>1</code> - Error (file not found, coverage data missing, stale coverage with <code>-S</code> / <code>--raise-on-stale</code>, etc.)</li> </ul> <h2 id=next-steps>Next Steps<a class=headerlink href=#next-steps title="Permanent link">&para;</a></h2> <ul> <li><strong><a href=../LIBRARY_API/ >Library API</a></strong> - Use in Ruby code</li> <li><strong><a href=../EXAMPLES/ >Examples</a></strong> - More usage examples and recipes</li> <li><strong><a href=../TROUBLESHOOTING/ >Troubleshooting</a></strong> - Common issues and solutions</li> </ul> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../ class="md-footer__link md-footer__link--prev" aria-label="Previous: Overview"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Overview </div> </div> </a> <a href=../MCP_INTEGRATION/ class="md-footer__link md-footer__link--next" aria-label="Next: MCP Integration"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> MCP Integration </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> </div> <div class=md-social> <a href=https://github.com/keithrbennett/cov-loupe target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://rubygems.org/gems/cov-loupe target=_blank rel=noopener title=rubygems.org class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M116.7 33.8c4.5-6.1 11.7-9.8 19.3-9.8h240c7.6 0 14.8 3.6 19.3 9.8l112 152c6.8 9.2 6.1 21.9-1.5 30.4l-232 256c-4.5 5-11 7.9-17.8 7.9s-13.2-2.9-17.8-7.9l-232-256c-7.7-8.5-8.3-21.2-1.5-30.4zm38.5 39.8c-3.3 2.5-4.2 7-2.1 10.5l57.4 95.7L63.3 192c-4.1.3-7.3 3.8-7.3 8s3.2 7.6 7.3 8l192 16h1.3l192-16c4.1-.3 7.3-3.8 7.3-8s-3.2-7.6-7.3-8l-147.2-12.3 57.4-95.6c2.1-3.5 1.2-8.1-2.1-10.5s-7.9-2-10.7 1l-90 97.6-90.1-97.6c-2.8-3-7.4-3.4-10.7-1"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"annotate": null, "base": "../..", "features": ["content.code.annotate", "content.code.copy", "content.tabs.link", "navigation.expand", "navigation.footer", "navigation.sections", "navigation.tabs", "navigation.top", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.79ae519e.min.js></script> </body> </html>